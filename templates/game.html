<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Jungle</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    <!-- Bootstrap CSS -->
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
        crossorigin="anonymous"
    />
  
    <!-- JS -->
    <script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        crossorigin="anonymous"
    ></script>
    <script
        src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"
    ></script>

    <script>
        let tenMillis = 0;
        let minutes = 0;
        let seconds = 0;
        let intervalId;

        $(document).ready(function() {
            clearInterval(intervalId);
            intervalId = setInterval(operateTimer, 10);
        });
        
        // 10ms 마다 시간에 대한 숫자가 증가한다!
        function operateTimer(){
            tenMillis++;
            document.getElementById("tenMillis").textContent = tenMillis > 9 ? tenMillis : '0' + tenMillis
            if(tenMillis > 99){
              seconds++;
              document.getElementById("seconds").textContent = seconds > 9 ? seconds : '0' + seconds
              tenMillis = 0
              document.getElementById("tenMillis").textContent = "00"
            }
            if(seconds > 59){
              minutes++;
              document.getElementById("minutes").textContent = minutes > 9 ? minutes : '0' + minutes
              seconds = 0
              document.getElementById("seconds").textContent = "00"    
            }
        }
        
        let cnt = 0;
        function submit(){
            toast('틀렸습니다!');
            cnt++;
            document.getElementById("solved_cnt").textContent = cnt;
            if(cnt == 3){
                window.location.href = '/result'
            }
        }

        function toast(string) {
            const toast = document.getElementById("toast");
        
            toast.classList.contains("reveal") ?
                (clearTimeout(removeToast), removeToast = setTimeout(function () {
                    document.getElementById("toast").classList.remove("reveal")
                }, 1000)) :
                removeToast = setTimeout(function () {
                    document.getElementById("toast").classList.remove("reveal")
                }, 1000)
            toast.classList.add("reveal"),
                toast.innerText = string
        }
    </script>
</head>

<body>
    <div class="nav">
        <!-- 수정 중 -->
    </div>
    <div class="main">
        <div class="game">
            <div class="game-form">
                <div class="form-group" id="game-form">
                    <!-- value에 문제 문장 넣기 -->
                  <input type="text" class="form-control" id="game-problem" value="잊지 마라, 네 인생의 주인은 너다." onpaste="return false;" oncopy="return false;" oncut="return false;" readonly>
                </div>
                <div class="form-group">
                  <label for="game-ans">Type the sentence above!</label>
                  <input type="text" class="form-control" id="game-ans" onpaste="return false;" oncopy="return false;" oncut="return false;">
                  <!-- js에서 document.getElementById('game-ans')의 value 값 얻어오면 됨. -->
                </div>
            </div>

            <div class="container text-center">
                <div class="row align-items-end">
                  <div class="col">
                    <div id="game-time">경과 시간 : 
                        <span id="minutes">00</span>:<span id="seconds">00</span>:<span id="tenMillis">00</span>
                    </div>
                    <div class="game-num">문제 수:
                        <span id="solved_cnt">0</span> / <span id="question_cnt">3</span>
                    </div>
                  </div>
                  <div class="col">
                  </div>
                  <div class="col">
                    <button id="game-ans-btn" onclick="submit()">Next</button>
                  </div>
                </div>
              </div>
        </div>

        <div id="toast"></div>
    </div>
</body>

</html>